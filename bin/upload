#!/bin/bash
#
# teknik.io upload

if [[ $# -eq 0 ]]; then
  echo "Usage: upload [file ..]"
  exit 1
fi

for arg; do
  out="$(curl -sf -F file="@${arg}" https://api.teknik.io/upload/post)"
  if [[ "${out}" =~ "error" ]]; then
    exit 1
  else
    out="${out##*name\":\"}"
    out="${out%%\"*}"
    echo "https://u.teknik.io/${out}"
  fi
done
