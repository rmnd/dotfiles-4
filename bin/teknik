#!/bin/bash
#
# Upload files to teknik.io.

if [[ $# -eq 0 ]]; then
  printf "usage: teknik <file ..>\n"
  exit 1
fi

for arg; do
  out="$(curl -sf -F file="@${arg}" https://api.teknik.io/upload/post)"
  if [[ "${out}" =~ "error" ]]; then
    exit 1
  else
    out="${out##*name\":\"}"
    out="${out%%\"*}"
    printf "https://u.teknik.io/${out}\n"
  fi
done
